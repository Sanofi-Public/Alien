<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>alien.models.pytorch package &mdash; ALIEN 1.1.2 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ALIEN
          </a>
              <div class="version">
                1.1.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="active_learning.html">What is active learning?</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="alien.models.html">alien.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="alien.selection.html">alien.selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="alien.benchmarks.html">alien.benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="alien.data.html">alien.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="alien.sample_generation.html">alien.sample_generation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ALIEN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">alien.models.pytorch package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/alien.models.pytorch.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="alien-models-pytorch-package">
<h1>alien.models.pytorch package<a class="headerlink" href="#alien-models-pytorch-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-alien.models.pytorch.last_layer">
<span id="alien-models-pytorch-last-layer-module"></span><h2>alien.models.pytorch.last_layer module<a class="headerlink" href="#module-alien.models.pytorch.last_layer" title="Permalink to this heading"></a></h2>
<p>Model wrapper for last layer linearization.</p>
<dl class="py class">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">alien.models.pytorch.last_layer.</span></span><span class="sig-name descname"><span class="pre">LastLayerPytorchLinearization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/last_layer.html#LastLayerPytorchLinearization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LastLayerLinearizableRegressor</span></code></p>
<p>“Last layer linearization for Pytorch-based models.</p>
<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.predict_with_embedding">
<span class="sig-name descname"><span class="pre">predict_with_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/last_layer.html#LastLayerPytorchLinearization.predict_with_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.predict_with_embedding" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass which returns the output of the penultimate layer along
with the output of the last layer. If the last layer is not known yet,
it will be determined when this function is called for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – one batch of data to use as input for the forward pass</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.last_layer_embedding">
<span class="sig-name descname"><span class="pre">last_layer_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/last_layer.html#LastLayerPytorchLinearization.last_layer_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.last_layer_embedding" title="Permalink to this definition"></a></dt>
<dd><p>Returns the activations of the last layer before the output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.linearization">
<span class="sig-name descname"><span class="pre">linearization</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/last_layer.html#LastLayerPytorchLinearization.linearization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.linearization" title="Permalink to this definition"></a></dt>
<dd><p>Finds the last-layer linearization of the model in its current
state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>weights, bias</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.set_last_layer">
<span class="sig-name descname"><span class="pre">set_last_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last_layer_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/alien/models/pytorch/last_layer.html#LastLayerPytorchLinearization.set_last_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.set_last_layer" title="Permalink to this definition"></a></dt>
<dd><p>Set the last layer of the model by its name. This sets the forward
hook to get the output of the penultimate layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>last_layer_name</strong> – the name of the last layer (fixed in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">model.named_modules()</span></code>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.find_last_layer">
<span class="sig-name descname"><span class="pre">find_last_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/last_layer.html#LastLayerPytorchLinearization.find_last_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.find_last_layer" title="Permalink to this definition"></a></dt>
<dd><p>Automatically determines the last layer of the model with one
forward pass. It assumes that the last layer is the same for every
forward pass and that it is an instance of <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Linear</span></code>.
Might not work with every architecture, but is tested with all PyTorch
torchvision classification models (besides SqueezeNet, which has no
linear last layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – batch of samples used to find last layer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the output of the forward pass, so as not to waste
computation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.covariance">
<span class="sig-name descname"><span class="pre">covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.covariance" title="Permalink to this definition"></a></dt>
<dd><p>Returns the covariance of the epistemic uncertainty between all
rows of X. This is where memory bugs often appear, because of the
large matrices involved.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.covariance_linear">
<span class="sig-name descname"><span class="pre">covariance_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.covariance_linear" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.embedding_method">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">embedding_method</span></span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.embedding_method" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.find_method">
<span class="sig-name descname"><span class="pre">find_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.find_method" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reinitialize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model to the given training data. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">X</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code> are
not specified, this method looks for <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.X</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.y</span></code>. If
<a class="reference internal" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit" title="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> finds an <code class="xref py py-obj docutils literal notranslate"><span class="pre">X</span></code> but not a <code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code>, it treats <code class="xref py py-obj docutils literal notranslate"><span class="pre">X</span></code> as a
combined dataset <a class="reference internal" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.data" title="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></a>, and then uses <code class="xref py py-obj docutils literal notranslate"><span class="pre">X,</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">data.X,</span> <span class="pre">data.y</span></code>.
If we can’t find <code class="xref py py-obj docutils literal notranslate"><span class="pre">data.X</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">data.y</span></code>, we instead use
<code class="xref py py-obj docutils literal notranslate"><span class="pre">X,</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">data[:-1],</span> <span class="pre">data[-1]</span></code>.</p>
<p><a class="reference internal" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit" title="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> should also fit any accompanying uncertainty model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reinitialize</strong> – If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, reinitializes model weights before
fitting. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>, starts training from previous weight values.
If not specified, uses <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.reinitialize</span></code>)</p></li>
<li><p><strong>fit_uncertainty</strong> – If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, a call to <a class="reference internal" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit" title="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> will also call
<a class="reference internal" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit_uncertainty" title="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit_uncertainty"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_uncertainty()</span></code></a>. Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit_model">
<span class="sig-name descname"><span class="pre">fit_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit_model" title="Permalink to this definition"></a></dt>
<dd><p>Fit just the model component, and not the uncertainties (if these are
computed separately)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit_uncertainty">
<span class="sig-name descname"><span class="pre">fit_uncertainty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit_uncertainty" title="Permalink to this definition"></a></dt>
<dd><p>Fit just the uncertainties (if these need additional fitting beyond
just the model)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.initialize" title="Permalink to this definition"></a></dt>
<dd><p>(Re)initializes the model weights. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.reinitialize</span></code> is True, this
should be called at the start of every <a class="reference internal" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit" title="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>, and this should be
the default behaviour of <a class="reference internal" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit" title="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.input_embedding">
<span class="sig-name descname"><span class="pre">input_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.input_embedding" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.load">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.load" title="Permalink to this definition"></a></dt>
<dd><p>Loads a model. This particular implementation only works if <code class="xref py py-obj docutils literal notranslate"><span class="pre">save(path)</span></code> hasn’t
been overloaded.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.method_names">
<span class="sig-name descname"><span class="pre">method_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{0:</span> <span class="pre">['_embedding',</span> <span class="pre">'embed',</span> <span class="pre">'embeddings'],</span> <span class="pre">1:</span> <span class="pre">['last_layer_embedding',</span> <span class="pre">'last_layer_embed',</span> <span class="pre">'embed_last_layer',</span> <span class="pre">'last_layer'],</span> <span class="pre">2:</span> <span class="pre">['input_embedding']}</span></em><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.method_names" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.ndim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.ndim" title="Permalink to this definition"></a></dt>
<dd><p>The number of axes in the feature space. Equal to <code class="xref py py-obj docutils literal notranslate"><span class="pre">len(self.shape)</span></code>.
Most commonly equal to 1. If training data have been specified, then
<code class="xref py py-obj docutils literal notranslate"><span class="pre">self.ndim</span> <span class="pre">==</span> <span class="pre">X.ndim</span> <span class="pre">-</span> <span class="pre">1</span></code>.</p>
<p>This property is used by any methods which use the <code class="xref py py-obj docutils literal notranslate"><span class="pre">&#64;flatten_batch</span></code>
decorator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.predict">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_std_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.predict" title="Permalink to this definition"></a></dt>
<dd><p>Applies the model to input(s) X (with the last self.ndim
axes corresponding to each sample), and returns prediction(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>return_std_dev</strong> – if True, returns a tuple <code class="xref py py-obj docutils literal notranslate"><span class="pre">(prediction,</span> <span class="pre">std_dev)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.predict_ensemble">
<span class="sig-name descname"><span class="pre">predict_ensemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.predict_ensemble" title="Permalink to this definition"></a></dt>
<dd><p>Returns a correlated ensemble of predictions for samples X.</p>
<p>Ensembles are correlated only over the last batch dimension,
corresponding to axis (-1 - self.ndim) of X. Earlier dimensions
have no guarantee of correlation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>multiple</strong> – standard deviation will be multiplied by this</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.predict_linear">
<span class="sig-name descname"><span class="pre">predict_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.predict_linear" title="Permalink to this definition"></a></dt>
<dd><p>Use the model’s linearization for a prediction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.predict_samples">
<span class="sig-name descname"><span class="pre">predict_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_covariance_for_ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.predict_samples" title="Permalink to this definition"></a></dt>
<dd><p>Makes a prediction for for the batch X, randomly selected from
this model’s posterior distribution. Gives an
ensemble of predictions, with shape <code class="xref py py-obj docutils literal notranslate"><span class="pre">(len(X),</span> <span class="pre">n)</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.save" title="Permalink to this definition"></a></dt>
<dd><p>Saves the model. May well be overloaded by subclasses, if they contain
non-picklable components (or pickling would be inefficient).</p>
<p>For any subclass, the <a class="reference internal" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.save" title="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> and <a class="reference internal" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.load" title="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a> methods should be
compatible with each other.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.shape" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the feature space. Can either be specified directly,
or inferred from training data, in which case
<code class="xref py py-obj docutils literal notranslate"><span class="pre">self.shape</span> <span class="pre">==</span> <span class="pre">X.shape[1:]</span></code>, i.e., the first (batch) dimension is
dropped.</p>
<p>This property is used by any methods which use the <code class="xref py py-obj docutils literal notranslate"><span class="pre">&#64;flatten_batch</span></code>
decorator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.last_layer.LastLayerPytorchLinearization.std_dev">
<span class="sig-name descname"><span class="pre">std_dev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization.std_dev" title="Permalink to this definition"></a></dt>
<dd><p>Returns the (epistemic) standard deviation of the model
on input <code class="xref py py-obj docutils literal notranslate"><span class="pre">X</span></code>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="alien-models-pytorch-lightning-module">
<h2>alien.models.pytorch.lightning module<a class="headerlink" href="#alien-models-pytorch-lightning-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-alien.models.pytorch.pytorch">
<span id="alien-models-pytorch-pytorch-module"></span><h2>alien.models.pytorch.pytorch module<a class="headerlink" href="#module-alien.models.pytorch.pytorch" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.init_weights">
<span class="sig-prename descclassname"><span class="pre">alien.models.pytorch.pytorch.</span></span><span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/pytorch.html#init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.pytorch.init_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.init_bias">
<span class="sig-prename descclassname"><span class="pre">alien.models.pytorch.pytorch.</span></span><span class="sig-name descname"><span class="pre">init_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/pytorch.html#init_bias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.pytorch.init_bias" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">alien.models.pytorch.pytorch.</span></span><span class="sig-name descname"><span class="pre">PytorchRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/pytorch.html#PytorchRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#alien.models.pytorch.last_layer.LastLayerPytorchLinearization" title="alien.models.pytorch.last_layer.LastLayerPytorchLinearization"><code class="xref py py-class docutils literal notranslate"><span class="pre">LastLayerPytorchLinearization</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">MCDropoutRegressor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">LinearizableLaplaceRegressor</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trainer</strong> – <p>Specifies how the model will be trained.
May be:</p>
<blockquote>
<div><p>’model’ — calls self.model.fit
‘lightning’ — trains with pytorch-lightning
trainer — calls trainer.fit
None — chooses from the above in order, if available</p>
</div></blockquote>
</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.fix_dropouts">
<span class="sig-name descname"><span class="pre">fix_dropouts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/pytorch.html#PytorchRegressor.fix_dropouts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.fix_dropouts" title="Permalink to this definition"></a></dt>
<dd><p>Retools dropouts for MC dropout prediction</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.get_lightning_trainer">
<span class="sig-name descname"><span class="pre">get_lightning_trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/pytorch.html#PytorchRegressor.get_lightning_trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.get_lightning_trainer" title="Permalink to this definition"></a></dt>
<dd><p>Rerturn a LightningTrainer object from current model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.fit_model">
<span class="sig-name descname"><span class="pre">fit_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reinitialize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/pytorch.html#PytorchRegressor.fit_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.fit_model" title="Permalink to this definition"></a></dt>
<dd><p>Fit just the model component, and not the uncertainties (if these are
computed separately)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/pytorch.html#PytorchRegressor.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.initialize" title="Permalink to this definition"></a></dt>
<dd><p>(Re)initializes the model weights. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.reinitialize</span></code> is True, this
should be called at the start of every <a class="reference internal" href="#alien.models.pytorch.pytorch.PytorchRegressor.fit" title="alien.models.pytorch.pytorch.PytorchRegressor.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>, and this should be
the default behaviour of <a class="reference internal" href="#alien.models.pytorch.pytorch.PytorchRegressor.fit" title="alien.models.pytorch.pytorch.PytorchRegressor.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_std_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/pytorch.html#PytorchRegressor.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.predict" title="Permalink to this definition"></a></dt>
<dd><p>Applies the model to input(s) X (with the last self.ndim
axes corresponding to each sample), and returns prediction(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>return_std_dev</strong> – if True, returns a tuple <code class="xref py py-obj docutils literal notranslate"><span class="pre">(prediction,</span> <span class="pre">std_dev)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.covariance">
<span class="sig-name descname"><span class="pre">covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.covariance" title="Permalink to this definition"></a></dt>
<dd><p>Returns the covariance of the epistemic uncertainty between all
rows of X. This is where memory bugs often appear, because of the
large matrices involved.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.covariance_ensemble">
<span class="sig-name descname"><span class="pre">covariance_ensemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.covariance_ensemble" title="Permalink to this definition"></a></dt>
<dd><p>Compute covariance from the ensemble of predictions</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.covariance_laplace">
<span class="sig-name descname"><span class="pre">covariance_laplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.covariance_laplace" title="Permalink to this definition"></a></dt>
<dd><p>Computes covariance using the Laplace approximation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.covariance_linear">
<span class="sig-name descname"><span class="pre">covariance_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.covariance_linear" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.embedding_method">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">embedding_method</span></span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.embedding_method" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.find_last_layer">
<span class="sig-name descname"><span class="pre">find_last_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.find_last_layer" title="Permalink to this definition"></a></dt>
<dd><p>Automatically determines the last layer of the model with one
forward pass. It assumes that the last layer is the same for every
forward pass and that it is an instance of <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Linear</span></code>.
Might not work with every architecture, but is tested with all PyTorch
torchvision classification models (besides SqueezeNet, which has no
linear last layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – batch of samples used to find last layer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the output of the forward pass, so as not to waste
computation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.find_method">
<span class="sig-name descname"><span class="pre">find_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.find_method" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reinitialize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model to the given training data. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">X</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code> are
not specified, this method looks for <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.X</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.y</span></code>. If
<a class="reference internal" href="#alien.models.pytorch.pytorch.PytorchRegressor.fit" title="alien.models.pytorch.pytorch.PytorchRegressor.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> finds an <code class="xref py py-obj docutils literal notranslate"><span class="pre">X</span></code> but not a <code class="xref py py-obj docutils literal notranslate"><span class="pre">y</span></code>, it treats <code class="xref py py-obj docutils literal notranslate"><span class="pre">X</span></code> as a
combined dataset <a class="reference internal" href="#alien.models.pytorch.pytorch.PytorchRegressor.data" title="alien.models.pytorch.pytorch.PytorchRegressor.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></a>, and then uses <code class="xref py py-obj docutils literal notranslate"><span class="pre">X,</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">data.X,</span> <span class="pre">data.y</span></code>.
If we can’t find <code class="xref py py-obj docutils literal notranslate"><span class="pre">data.X</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">data.y</span></code>, we instead use
<code class="xref py py-obj docutils literal notranslate"><span class="pre">X,</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">data[:-1],</span> <span class="pre">data[-1]</span></code>.</p>
<p><a class="reference internal" href="#alien.models.pytorch.pytorch.PytorchRegressor.fit" title="alien.models.pytorch.pytorch.PytorchRegressor.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> should also fit any accompanying uncertainty model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reinitialize</strong> – If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, reinitializes model weights before
fitting. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>, starts training from previous weight values.
If not specified, uses <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.reinitialize</span></code>)</p></li>
<li><p><strong>fit_uncertainty</strong> – If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, a call to <a class="reference internal" href="#alien.models.pytorch.pytorch.PytorchRegressor.fit" title="alien.models.pytorch.pytorch.PytorchRegressor.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> will also call
<a class="reference internal" href="#alien.models.pytorch.pytorch.PytorchRegressor.fit_uncertainty" title="alien.models.pytorch.pytorch.PytorchRegressor.fit_uncertainty"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_uncertainty()</span></code></a>. Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.fit_laplace">
<span class="sig-name descname"><span class="pre">fit_laplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.fit_laplace" title="Permalink to this definition"></a></dt>
<dd><p>Fits the Laplace approximation to the (last layer of)
the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.fit_uncertainty">
<span class="sig-name descname"><span class="pre">fit_uncertainty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.fit_uncertainty" title="Permalink to this definition"></a></dt>
<dd><p>Fit just the uncertainties (if these need additional fitting beyond
just the model)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.input_embedding">
<span class="sig-name descname"><span class="pre">input_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.input_embedding" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.last_layer_embedding">
<span class="sig-name descname"><span class="pre">last_layer_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.last_layer_embedding" title="Permalink to this definition"></a></dt>
<dd><p>Returns the activations of the last layer before the output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.linearization">
<span class="sig-name descname"><span class="pre">linearization</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.linearization" title="Permalink to this definition"></a></dt>
<dd><p>Finds the last-layer linearization of the model in its current
state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>weights, bias</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.load">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.load" title="Permalink to this definition"></a></dt>
<dd><p>Loads a model. This particular implementation only works if <code class="xref py py-obj docutils literal notranslate"><span class="pre">save(path)</span></code> hasn’t
been overloaded.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.method_names">
<span class="sig-name descname"><span class="pre">method_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{0:</span> <span class="pre">['_embedding',</span> <span class="pre">'embed',</span> <span class="pre">'embeddings'],</span> <span class="pre">1:</span> <span class="pre">['last_layer_embedding',</span> <span class="pre">'last_layer_embed',</span> <span class="pre">'embed_last_layer',</span> <span class="pre">'last_layer'],</span> <span class="pre">2:</span> <span class="pre">['input_embedding']}</span></em><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.method_names" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.ndim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.ndim" title="Permalink to this definition"></a></dt>
<dd><p>The number of axes in the feature space. Equal to <code class="xref py py-obj docutils literal notranslate"><span class="pre">len(self.shape)</span></code>.
Most commonly equal to 1. If training data have been specified, then
<code class="xref py py-obj docutils literal notranslate"><span class="pre">self.ndim</span> <span class="pre">==</span> <span class="pre">X.ndim</span> <span class="pre">-</span> <span class="pre">1</span></code>.</p>
<p>This property is used by any methods which use the <code class="xref py py-obj docutils literal notranslate"><span class="pre">&#64;flatten_batch</span></code>
decorator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.predict_ensemble">
<span class="sig-name descname"><span class="pre">predict_ensemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.predict_ensemble" title="Permalink to this definition"></a></dt>
<dd><p>Returns an ensemble of predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>multiple</strong> – standard deviation should be this much larger</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.predict_linear">
<span class="sig-name descname"><span class="pre">predict_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.predict_linear" title="Permalink to this definition"></a></dt>
<dd><p>Use the model’s linearization for a prediction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.predict_samples">
<span class="sig-name descname"><span class="pre">predict_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/pytorch.html#PytorchRegressor.predict_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.predict_samples" title="Permalink to this definition"></a></dt>
<dd><p>Makes a prediction for for the batch X, randomly selected from
this model’s posterior distribution. Gives an
ensemble of predictions, with shape <code class="xref py py-obj docutils literal notranslate"><span class="pre">(len(X),</span> <span class="pre">n)</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.predict_with_embedding">
<span class="sig-name descname"><span class="pre">predict_with_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.predict_with_embedding" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass which returns the output of the penultimate layer along
with the output of the last layer. If the last layer is not known yet,
it will be determined when this function is called for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> – one batch of data to use as input for the forward pass</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.save" title="Permalink to this definition"></a></dt>
<dd><p>Saves the model. May well be overloaded by subclasses, if they contain
non-picklable components (or pickling would be inefficient).</p>
<p>For any subclass, the <a class="reference internal" href="#alien.models.pytorch.pytorch.PytorchRegressor.save" title="alien.models.pytorch.pytorch.PytorchRegressor.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> and <a class="reference internal" href="#alien.models.pytorch.pytorch.PytorchRegressor.load" title="alien.models.pytorch.pytorch.PytorchRegressor.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a> methods should be
compatible with each other.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.set_last_layer">
<span class="sig-name descname"><span class="pre">set_last_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last_layer_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.set_last_layer" title="Permalink to this definition"></a></dt>
<dd><p>Set the last layer of the model by its name. This sets the forward
hook to get the output of the penultimate layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>last_layer_name</strong> – the name of the last layer (fixed in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">model.named_modules()</span></code>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.shape" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the feature space. Can either be specified directly,
or inferred from training data, in which case
<code class="xref py py-obj docutils literal notranslate"><span class="pre">self.shape</span> <span class="pre">==</span> <span class="pre">X.shape[1:]</span></code>, i.e., the first (batch) dimension is
dropped.</p>
<p>This property is used by any methods which use the <code class="xref py py-obj docutils literal notranslate"><span class="pre">&#64;flatten_batch</span></code>
decorator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.std_dev">
<span class="sig-name descname"><span class="pre">std_dev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.std_dev" title="Permalink to this definition"></a></dt>
<dd><p>Returns the (epistemic) standard deviation of the model
on input <code class="xref py py-obj docutils literal notranslate"><span class="pre">X</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.std_dev_ensemble">
<span class="sig-name descname"><span class="pre">std_dev_ensemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.std_dev_ensemble" title="Permalink to this definition"></a></dt>
<dd><p>Returns the (epistemic) standard deviation of the model
on input <code class="xref py py-obj docutils literal notranslate"><span class="pre">X</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alien.models.pytorch.pytorch.PytorchRegressor.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#alien.models.pytorch.pytorch.PytorchRegressor.dtype" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-alien.models.pytorch.training_limits">
<span id="alien-models-pytorch-training-limits-module"></span><h2>alien.models.pytorch.training_limits module<a class="headerlink" href="#module-alien.models.pytorch.training_limits" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.get_training_limit">
<span class="sig-prename descclassname"><span class="pre">alien.models.pytorch.training_limits.</span></span><span class="sig-name descname"><span class="pre">get_training_limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/training_limits.html#get_training_limit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.training_limits.get_training_limit" title="Permalink to this definition"></a></dt>
<dd><p><strong>* Decorator *</strong></p>
<p>Modifies a function so that it can take any of a number of
different naive arguments to specify limits to pytorch training.
The inner (wrapped) function will see only an argument
<code class="xref py py-obj docutils literal notranslate"><span class="pre">training_limit</span></code>, which receives an instance of the fancy
TrainingLimit class.</p>
<p>Thus, the inner fn must have an argument named <code class="xref py py-obj docutils literal notranslate"><span class="pre">training_limit</span></code>
(or <code class="xref py py-obj docutils literal notranslate"><span class="pre">**kwargs</span></code>).</p>
<dl class="simple">
<dt>The outer, decorated fn may take additional optional kwargs:</dt><dd><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">'sample_limit'</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">'batch_limit'</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">'epoch_limit'</span></code>
<code class="xref py py-obj docutils literal notranslate"><span class="pre">'samples'</span></code>,      <code class="xref py py-obj docutils literal notranslate"><span class="pre">'batches'</span></code>,     <code class="xref py py-obj docutils literal notranslate"><span class="pre">'epochs'</span></code></p>
</dd>
</dl>
<p>If these are given, they determine the value of training_limit
according a calculation that favors them in the order
provided (though you may only want to provide one).</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.TrainingLimit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">alien.models.pytorch.training_limits.</span></span><span class="sig-name descname"><span class="pre">TrainingLimit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/training_limits.html#TrainingLimit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.training_limits.TrainingLimit" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Encapsulates the computation of training limits, which may depend on
things like dataset length.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.TrainingLimit.min_samples">
<span class="sig-name descname"><span class="pre">min_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.TrainingLimit.min_samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.TrainingLimit.min_epochs">
<span class="sig-name descname"><span class="pre">min_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.TrainingLimit.min_epochs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.TrainingLimit.samples">
<span class="sig-name descname"><span class="pre">samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.TrainingLimit.samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.TrainingLimit.epochs">
<span class="sig-name descname"><span class="pre">epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.TrainingLimit.epochs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.TrainingLimit.batches">
<span class="sig-name descname"><span class="pre">batches</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.TrainingLimit.batches" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.TrainingLimit.max_samples">
<span class="sig-name descname"><span class="pre">max_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.TrainingLimit.max_samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.TrainingLimit.max_epochs">
<span class="sig-name descname"><span class="pre">max_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.TrainingLimit.max_epochs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.TrainingLimit.sample_limit">
<span class="sig-name descname"><span class="pre">sample_limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/training_limits.html#TrainingLimit.sample_limit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.training_limits.TrainingLimit.sample_limit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.TrainingLimit.batch_limit">
<span class="sig-name descname"><span class="pre">batch_limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/training_limits.html#TrainingLimit.batch_limit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.training_limits.TrainingLimit.batch_limit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.StdLimit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">alien.models.pytorch.training_limits.</span></span><span class="sig-name descname"><span class="pre">StdLimit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/training_limits.html#StdLimit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.training_limits.StdLimit" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#alien.models.pytorch.training_limits.TrainingLimit" title="alien.models.pytorch.training_limits.TrainingLimit"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingLimit</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.StdLimit.batch_limit">
<span class="sig-name descname"><span class="pre">batch_limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.training_limits.StdLimit.batch_limit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.StdLimit.batches">
<span class="sig-name descname"><span class="pre">batches</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.StdLimit.batches" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.StdLimit.epochs">
<span class="sig-name descname"><span class="pre">epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.StdLimit.epochs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.StdLimit.max_epochs">
<span class="sig-name descname"><span class="pre">max_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.StdLimit.max_epochs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.StdLimit.max_samples">
<span class="sig-name descname"><span class="pre">max_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.StdLimit.max_samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.StdLimit.min_epochs">
<span class="sig-name descname"><span class="pre">min_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.StdLimit.min_epochs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.StdLimit.min_samples">
<span class="sig-name descname"><span class="pre">min_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.StdLimit.min_samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.StdLimit.sample_limit">
<span class="sig-name descname"><span class="pre">sample_limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alien.models.pytorch.training_limits.StdLimit.sample_limit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="alien.models.pytorch.training_limits.StdLimit.samples">
<span class="sig-name descname"><span class="pre">samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#alien.models.pytorch.training_limits.StdLimit.samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-alien.models.pytorch.utils">
<span id="alien-models-pytorch-utils-module"></span><h2>alien.models.pytorch.utils module<a class="headerlink" href="#module-alien.models.pytorch.utils" title="Permalink to this heading"></a></h2>
<p>Helper functions for Pytorch models.</p>
<dl class="py function">
<dt class="sig sig-object py" id="alien.models.pytorch.utils.as_tensor">
<span class="sig-prename descclassname"><span class="pre">alien.models.pytorch.utils.</span></span><span class="sig-name descname"><span class="pre">as_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/utils.html#as_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.utils.as_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Return the tensor version of x (i.e. itself it it already is ArrayLike, or x.data)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alien.models.pytorch.utils.dropout_forward">
<span class="sig-prename descclassname"><span class="pre">alien.models.pytorch.utils.</span></span><span class="sig-name descname"><span class="pre">dropout_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/utils.html#dropout_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.utils.dropout_forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alien.models.pytorch.utils.submodules">
<span class="sig-prename descclassname"><span class="pre">alien.models.pytorch.utils.</span></span><span class="sig-name descname"><span class="pre">submodules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">frozenset({})</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/alien/models/pytorch/utils.html#submodules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#alien.models.pytorch.utils.submodules" title="Permalink to this definition"></a></dt>
<dd><p>Iterator through submodules of <code class="xref py py-obj docutils literal notranslate"><span class="pre">module</span></code> (paired with their names,
if <code class="xref py py-obj docutils literal notranslate"><span class="pre">include_names</span></code> is True). A submodule is returned only once, on its
first occurence in a depth-first traversal.</p>
<p>Any modules in <code class="xref py py-obj docutils literal notranslate"><span class="pre">skip</span></code> (given either as the actual module, or its name)
will be skipped, along with all their submodules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong> (<em>torch.nn.module</em>) – The module, whose submodules we will
iterate through.</p></li>
<li><p><strong>include_names</strong> (<em>bool</em>) – True, the iterator yields pairs <code class="xref py py-obj docutils literal notranslate"><span class="pre">(name,</span> <span class="pre">submodule)</span></code>,
otherwise it yields just <code class="xref py py-obj docutils literal notranslate"><span class="pre">submodule</span></code>. (The returned name is the name it’s
indexed as the first time it occurs in the tree. If the submodule is not
named, its name will return as <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>skip</strong> – A collection of modules to skip. Can contain
either modules themselves, and/or their names.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-alien.models.pytorch">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-alien.models.pytorch" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>